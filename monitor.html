<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caring Heart - Monitor Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <div class="header-brand">
            <img src="img/slazzer-edit-image-removebg-preview (1)_preview_rev_1.png" alt="Caring Heart Logo" class="header-logo" />
            <h1 class="brand-title">Caring Heart</h1>
        </div>
        <button class="menu-toggle" aria-label="Toggle Menu" onclick="toggleDropdown()">
            <i class="fas fa-bars"></i>
        </button>
        <div class="dropdown-panel" id="dropdownPanel">
            </div>
    </header>

    <div class="container">
        <section class="portal-header">
            <h2>Monitor Dashboard</h2>
            <p class="sub-heading">Manage student attendance records and add/remove students for <span id="selectedClassName">[No Class Selected]</span>.</p>
        </section>

        <section class="class-selection-section">
            <h2>Select Class</h2>
            <div class="class-selection" id="classButtonsContainer">
                </div>
            <p class="info-text">Select a class to view and manage its students and attendance.</p>
        </section>

        <section class="date-selection-section">
            <h2>Select Date for Attendance Management</h2>
            <div class="input-group">
                <label for="attendanceDateMonitor" class="sr-only">Attendance Date</label>
                <input type="date" id="attendanceDateMonitor" />
                <button id="loadAttendanceBtn" class="action-button primary-button">
                    <i class="fas fa-calendar-check icon"></i> Load Attendance
                </button>
            </div>
        </section>

        <section class="attendance-management-section">
            <h2>Attendance Records for <span id="displayDate"></span></h2>
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Roll Number</th>
                            <th>Student Name</th>
                            <th>Status</th>
                            <th>Quick Remove</th> </tr>
                    </thead>
                    <tbody id="monitorAttendanceTableBody">
                        <tr><td colspan="4">Select a class and date to manage attendance.</td></tr>
                    </tbody>
                </table>
            </div>
            <button id="saveAttendanceBtn" class="action-button save-button" style="margin-top: 20px;">
                <i class="fas fa-save icon"></i> Save Changes
            </button>
            <p id="attendanceMessage" class="info-text small-text"></p>
        </section>

        <section class="add-remove-student-section">
            <div class="section-column">
                <h3>Add New Student</h3>
                <p class="warning-text">Enter unique roll number and name to add a student to the selected class.</p>
                <div class="input-group">
                    <label for="newStudentRoll" class="sr-only">New Student Roll No.</label>
                    <input type="text" id="newStudentRoll" placeholder="Roll Number (e.g., 016)" />
                    <label for="newStudentName" class="sr-only">New Student Name</label>
                    <input type="text" id="newStudentName" placeholder="Student Name" />
                    <button id="addStudentBtn" class="action-button add-button">
                        <i class="fas fa-user-plus icon"></i> Add Student
                    </button>
                </div>
                <p id="addStudentMessage" class="info-text"></p>
            </div>
            <div class="section-column">
                <h3>Permanently Remove Student (By Name)</h3>
                <p class="warning-text"><strong>WARNING:</strong> This action permanently removes the student's profile AND all their attendance records for the selected class. It cannot be undone.</p>
                <div class="input-group">
                    <label for="studentToRemoveName" class="sr-only">Student Name to Remove</label>
                    <input type="text" id="studentToRemoveName" placeholder="Student Name to Remove">
                    <button class="action-button delete-button" id="removeStudentByNameBtn">
                        <i class="fas fa-user-minus icon"></i> Remove Student
                    </button>
                </div>
                <p id="removeStudentMessage" class="info-text"></p>
            </div>
        </section>

        <div class="navigation-buttons">
            <a href="index.html" class="section-button small-button">
                <i class="fas fa-home icon"></i>
                <span class="button-text">Home</span>
            </a>
        </div>

        <footer class="system-footer" role="contentinfo">
            <p>&copy; <span id="current-year"></span> Caring Heart. All rights reserved.</p>
            <p>Made with &hearts; by Nyola Gift.</p>
            <p>Powered by Firebase.</p>
        </footer>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="js/firebase-init.js"></script>
    <script src="js/monitor.js"></script> <script>
        // Set current year in footer dynamically
        document.getElementById('current-year').textContent = new Date().getFullYear();

        // Toggle dropdown menu for mobile/smaller screens
        function toggleDropdown() {
            const dropdown = document.getElementById('dropdownPanel');
            dropdown.classList.toggle('show');
            const menuToggleBtn = document.querySelector('.menu-toggle');
            const isExpanded = menuToggleBtn.getAttribute('aria-expanded') === 'true';
            menuToggleBtn.setAttribute('aria-expanded', !isExpanded);
        }
    </script>
</body>
</html>
